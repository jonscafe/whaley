# Server Configuration
HOST=0.0.0.0
PORT=8000
DEBUG=false

# Authentication Mode: "ctfd" or "none"
AUTH_MODE=none

# CTFd Configuration (only needed if AUTH_MODE=ctfd)
CTFD_URL=https://your-ctfd-instance.com
CTFD_API_KEY=your_admin_api_key

# Admin Dashboard Configuration
# Generate a strong random key: openssl rand -hex 32
ADMIN_KEY=your_secret_admin_key_here

# Instance Settings
MAX_INSTANCES_PER_USER=3
MAX_INSTANCES_PER_TEAM=5
INSTANCE_TIMEOUT=3600

# Port Range for Challenge Instances
PORT_RANGE_START=30000
PORT_RANGE_END=40000

# Challenges Directory
CHALLENGES_DIR=/challenges

# Public host for instance access
# Set to "auto" for automatic IP detection, or specify your VPS IP/domain
PUBLIC_HOST=auto

# =============================================================================
# Database Configuration
# =============================================================================
# SQLite (default - good for single server deployments)
DATABASE_URL=sqlite+aiosqlite:///./data/whaley.db

# PostgreSQL (recommended for high-load multi-worker deployments)
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/whaley

# Data directory for SQLite
DATA_DIR=/app/data

# =============================================================================
# Redis Configuration (Required for multi-worker deployments)
# =============================================================================
# Redis URL for distributed locking
# Leave empty to use local asyncio locks (single worker only)
REDIS_URL=redis://redis:6379/0

# =============================================================================
# Network Isolation
# =============================================================================
# Create isolated Docker network per instance (recommended)
NETWORK_ISOLATION_ENABLED=true

# Disable inter-container communication within instance network
NETWORK_ICC_DISABLED=true

# Prefix for instance network names
NETWORK_PREFIX=whaley

# =============================================================================
# Dynamic Flags 
# =============================================================================
# Enable per-user unique flags - each user gets different flag per challenge
# Requires AUTH_MODE=ctfd and valid CTFD_API_KEY with admin permissions
DYNAMIC_FLAGS_ENABLED=false

# Prefix for generated flags (e.g., FLAG{random_hex} or CTF{random_hex})
FLAG_PREFIX=FLAG

# =============================================================================
# Instance Forensics (Docker Log Capture)
# =============================================================================
# Auto-capture logs when instances terminate
FORENSICS_AUTO_CAPTURE=false

# Maximum log size per instance (MB)
FORENSICS_MAX_SIZE_MB=5

# Maximum lines to capture per container
FORENSICS_TAIL_LINES=1000

# Auto-delete logs older than this (hours)
FORENSICS_RETENTION_HOURS=168

# Compress logs with gzip
FORENSICS_COMPRESSION=true
